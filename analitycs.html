<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rutas y An√°lisis - Costa Transportes</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lykmapipo/themify-icons@0.1.2/css/themify-icons.css">
    <link rel="stylesheet" href="css/table.css">
    <link rel="stylesheet" href="css/analytics.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>

<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo-container">
                <div class="logo">
                    <img src="css/logo.jpg" alt="Costa Transportes" class="logo-img">
                </div>
            </div>
            
            <nav class="nav-menu">
                <a href="index.html" class="nav-link" data-tab="providers">
                    <i class="ti-home sidemenu-icon menu-icon"></i>
                    <span class="menu-title">Proveedores</span>
                </a>
                <a href="payments.html" class="nav-link" data-tab="payments">
                    <i class="ti-wallet sidemenu-icon menu-icon"></i>
                    <span class="menu-title">Pagos</span>
                </a>
                <a href="routes.html" class="nav-link" data-tab="routes">
                    <i class="ti-direction-alt sidemenu-icon menu-icon"></i>
                    <span class="menu-title">Rutas</span>
                </a>
                <div class="sidebar-nav">
                <a href="analitycs.html" class="nav-link active" data-tab="analiticas">
                    <i class="ti-bar-chart sidemenu-icon menu-icon"></i>
                    <span class="menu-title">An√°lisis</span>
                </a>
                </div>
            </nav>
            
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h1>An√°lisis & M√©tricas</h1>
            </div>
            

<!-- Secci√≥n de An√°lisis -->
<div id="analiticas" class="tab-content" style="display: none;">
    <div class="analytics-container">
        <div class="analytics-header">
            <h2>üìä Dashboard de M√©tricas</h2>
            <p>Costa Transportes - An√°lisis de Rendimiento</p>
        </div>

        <!-- Tarjetas de estad√≠sticas -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="totalRevenue">$12,520,000</div>
                <div class="stat-label">Recaudaci√≥n Total</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalCommission">$2,504,000</div>
                <div class="stat-label">Comisi√≥n Total</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="netPayment">$10,016,000</div>
                <div class="stat-label">Pago Neto Total</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="avgOccupancy">53%</div>
                <div class="stat-label">Ocupaci√≥n Promedio</div>
            </div>
        </div>

        <!-- Filtros -->
        <div class="filters">
            <button class="filter-btn active" onclick="filterData('all')">Todos</button>
            <button class="filter-btn" onclick="filterData('tacoha')">Tacoha</button>
            <button class="filter-btn" onclick="filterData('traveltur')">Traveltur</button>
        </div>

        <!-- Tarjetas de proveedores -->
        <div class="provider-cards">
            <div class="provider-card tacoha">
                <div class="provider-name">üöå Tacoha</div>
                <div class="provider-info">
                    <div class="info-item">
                        <span class="info-label">Representante:</span>
                        <span class="info-value">Jorge Martinez</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Comisi√≥n:</span>
                        <span class="info-value">20%</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Rutas:</span>
                        <span class="info-value">3</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Estado:</span>
                        <span class="info-value" style="color: #28a745;">‚úÖ Aprobado</span>
                    </div>
                </div>
            </div>
            
            <div class="provider-card traveltur">
                <div class="provider-name">üöê Traveltur</div>
                <div class="provider-info">
                    <div class="info-item">
                        <span class="info-label">Representante:</span>
                        <span class="info-value">Rodrigo Mu√±oz</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Comisi√≥n:</span>
                        <span class="info-value">15%</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Rutas:</span>
                        <span class="info-value">3</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Estado:</span>
                        <span class="info-value" style="color: #007bff;">‚è≥ Pendiente</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gr√°ficos -->
        <div class="charts-grid">
            <div class="chart-container">
                <div class="chart-title">üí∞ Distribuci√≥n de Ingresos por Proveedor</div>
                <canvas id="revenueChart"></canvas>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">üìä Comparaci√≥n de Comisiones</div>
                <canvas id="commissionChart"></canvas>
            </div>
            
            <div class="chart-container full-width-chart">
                <div class="chart-title">üìà An√°lisis de Rendimiento por Ruta</div>
                <canvas id="routePerformanceChart"></canvas>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">üéØ Ocupaci√≥n por Proveedor</div>
                <canvas id="occupancyChart"></canvas>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">üí≥ Pagos Netos Comparativos</div>
                <canvas id="netPaymentChart"></canvas>
            </div>
        </div>

        <!-- An√°lisis de rutas -->
        <div class="route-analysis">
            <div class="chart-title">üó∫Ô∏è An√°lisis Detallado de Rutas</div>
            <table class="route-table">
                <thead>
                    <tr>
                        <th id="th-t">Ruta</th>
                        <th id="th-t">Proveedor</th>
                        <th id="th-t">Recaudaci√≥n</th>
                        <th id="th-t">Ocupaci√≥n</th>
                        <th id="th-t">Eficiencia</th>
                        <th id="th-t">Pago Neto</th>
                    </tr>
                </thead>
                <tbody id="routeTableBody">
                </tbody>
            </table>
        </div>
    </div>
</div>

    <!-- Script para el cambio de pesta√±as -->
    <script>
        // Funcionalidad para cambiar entre pesta√±as
        document.addEventListener('DOMContentLoaded', function() {
            // Mostrar la pesta√±a activa por defecto
            showTab('tabla-rutas');
            
            // Agregar manejadores de eventos a los enlaces del men√∫
            document.querySelectorAll('.sidebar-nav a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tabId = this.getAttribute('href').substring(1);
                    showTab(tabId);
                    
                    // Actualizar la clase activa en los enlaces del men√∫
                    document.querySelectorAll('.sidebar-nav a').forEach(a => a.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        });
        
        function showTab(tabId) {
            // Ocultar todos los contenidos de pesta√±as
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'block';
            });
            
            // Mostrar la pesta√±a seleccionada
            const activeTab = document.getElementById(tabId);
            if (activeTab) {
                activeTab.style.display = 'block';
            }
        }
    </script>
    
    <!-- Incluir el archivo de an√°lisis -->
    <script src="js/analytics.js"></script>
    
    <script>
        // Funcionalidad para agregar interactividad
            document.addEventListener('DOMContentLoaded', function () {
                const table = document.getElementById('proveedoresTable');

                // Funci√≥n para formatear n√∫meros como moneda
                function formatCurrency(value) {
                    if (!value || value === '') return '';
                    const num = parseFloat(value.replace(/[\$,]/g, ''));
                    if (isNaN(num)) return value;
                    return '$' + num.toLocaleString('es-CL');
                }

                // Funci√≥n para formatear n√∫meros
                function formatNumber(value) {
                    if (!value || value === '') return '';
                    const num = parseFloat(value.replace(/[,]/g, ''));
                    if (isNaN(num)) return value;
                    return num.toLocaleString('es-CL');
                }

                // Agregar funcionalidad de edici√≥n en l√≠nea (opcional)
                const editableCells = table.querySelectorAll('.currency, .numeric');
                editableCells.forEach(cell => {
                    cell.addEventListener('dblclick', function () {
                        const originalText = this.textContent;
                        const input = document.createElement('input');
                        input.type = 'text';
                        input.value = originalText;
                        input.style.width = '100%';
                        input.style.border = 'none';
                        input.style.outline = 'none';
                        input.style.background = '#fff3cd';

                        this.textContent = '';
                        this.appendChild(input);
                        input.focus();

                        function saveChanges() {
                            const newValue = input.value;
                            this.textContent = newValue;
                            // Aqu√≠ puedes agregar l√≥gica para guardar los cambios
                            // Por ejemplo, usando fetch para enviar al servidor
                            console.log('Nuevo valor:', newValue);
                        }

                        input.addEventListener('blur', saveChanges);
                        input.addEventListener('keypress', function (e) {
                            if (e.key === 'Enter') {
                                saveChanges();
                            } else if (e.key === 'Escape') {
                                this.parentNode.textContent = originalText;
                            }
                        });
                    });
                });
            });

        </script>
    </body>
</html>